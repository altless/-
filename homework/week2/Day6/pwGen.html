<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Password Generator</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/meyer-reset/2.0/reset.min.css">
    <link rel="stylesheet" href="reset.css">
    <link rel="stylesheet" href="style.css">
    <style>

    </style>
</head>

<body>
    <div class="container">
        <div class="input-group">
            <input type="text" id="password" placeholder="ìƒì„±ëœ ë¹„ë°€ë²ˆí˜¸">
            <button class="copy-btn">ğŸ“‹</button>
        </div>
        <div class="length-controls">
            <span class="length-label">ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´</span>
            <input type="number" id="length" min="5" max="70" value="12" placeholder="ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´">
            <button class="random-length">ëœë¤</button>
        </div>
        <div class="options">
            <label><input type="checkbox" id="numbers"> Numbers (0-9)</label>
            <label><input type="checkbox" id="lowercase"> Small Letters (a-z)</label>
            <label><input type="checkbox" id="uppercase"> Capital Letters (A-Z)</label>
            <label><input type="checkbox" id="symbols"> Symbols (@,!,#,$,%,&)</label>
        </div>
        <div class="rules">
            ìµœì†Œ ê¸¸ì´ëŠ” 5ì…ë‹ˆë‹¤.<br>
            ìµœëŒ€ ê¸¸ì´ëŠ” 70ì…ë‹ˆë‹¤.<br>
            ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ëŠ” 10~16ìì—¬ì•¼ í•©ë‹ˆë‹¤.
        </div>
        <button class="button" id="generate-btn">ìƒì„±í•˜ê¸°</button>
        <button class="button" id="strong-btn">ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸</button>
        <button class="button" id="ultra-btn">ì´ˆê°•ë ¥ ë¹„ë°€ë²ˆí˜¸ (70ì)</button>
    </div>
    <script>
        class PasswordGenerator {
            constructor() {
                this.charSets = {
                    numbers: "0123456789",
                    lowercase: "abcdefghijklmnopqrstuvwxyz",
                    uppercase: "ABCDEFGHIJKLMNOPQRSTUVWXYZ",
                    symbols: "@!#$%&"
                };
            }

            generate(length, options) {
//////////////////////////////////////////////// ì„ íƒëœ ì„ íƒì§€ë§Œ ë°˜í™˜í•˜ê¸° ///////////////////////////////////////////////                
                const selectedTypes = Object.keys(this.charSets).filter(passType => options[passType]);
                if (selectedTypes.length === 0) {
                    alert("ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”");
                }

//////////////////////////////////////////////// passwordì— ëœë¤ íƒ€ì…ì˜ charset valueê°’ì„ ëœë¤í•˜ê²Œ ë„£ê¸° ///////////////////////////////////////////////
                let password = "";
                console.log(length);
                for (let i = 0; i < length; i++) {

                    
                    const randomType = selectedTypes[Math.floor(Math.random() * selectedTypes.length)]; //ì²´í¬ëœ ì˜µì…˜ì¤‘ ëœë¤í•˜ê²Œ í•˜ë‚˜ ì„ íƒ
                    const charSet = this.charSets[randomType]; // ì„ íƒëœ ì˜µì…˜ì˜ ë¬¸ìì—´
                    password += charSet[Math.floor(Math.random() * charSet.length)]; //ë¬¸ìì—´ì„ ì¸ë±ìŠ¤ë¡œ ì ‘ê·¼í•´ì„œ í•˜ë‚˜ ì¶”ê°€
                }
                return password;
            }
        }

        const generator = new PasswordGenerator();
        const passwordField = document.getElementById("password");
        const lengthInput = document.getElementById("length");
        const copyBtn = document.querySelector(".copy-btn");
        const generateBtn = document.querySelector("#generate-btn");
        const strongBtn = document.querySelector("#strong-btn");
        const ultraBtn = document.querySelector("#ultra-btn");
        const randomLengthBtn = document.querySelector(".random-length");


//////////////////////////////////////////////// ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ ì œí•œ, ì˜ëª»ëœ ê°’ ì…ë ¥ì‹œ ì´ì „ê°’ìœ¼ë¡œ ë°”ê¾¸ê¸° ///////////////////////////////////////////////
        let previousValue = lengthInput.value;
        lengthInput.addEventListener("blur", function() { 
            //input ì´ë²¤íŠ¸ ë°›ì„ì‹œ 21 ì…ë ¥í•˜ë ¤ê³  í–ˆëŠ”ë° 2ì—ì„œ ì˜¤ë¥˜ ì•Œë¦¼ 
            //ì‹œê°„ ì°¨ë¥¼ ë‘ê³  í•˜ë ¤ë‹¤ê°€ ì–´ìƒ‰í•´ì ¸ blurë¡œ ë³€ê²½ 
            let length = this.value;

            if (isNaN(length) || length < 5 || length > 70) {
                alert("ë¹„ë°€ë²ˆí˜¸ ê¸¸ì´ëŠ” 5~70 ì‚¬ì´ì—¬ì•¼ í•©ë‹ˆë‹¤.");
                this.value = previousValue;
            } else {
                previousValue = this.value;
            }
        });


//////////////////////////////////////////////// checked ì†ì„±í™œìš©, í™œì„±í™”ëœ ì„ íƒì§€ ì²´í¬, ê°•ë ¥í•œ ë¹„ë°€ë²ˆí˜¸ëŠ” ëª¨ë‘ í™œì„±í™” ì‹œí‚¤ê¸° ///////////////////////////////////////////////
        function getOptions(length = null, forceAll = false) {
            return {
                length: length !== null ? length : parseInt(lengthInput.value), //ê¸¸ì´ê°’ì„ ë„£ì–´ í˜¸ì¶œì‹œ í•´ë‹¹ ê¸¸ì´ê°’ ì‚¬ìš© ì•„ë‹ˆë©´ ì‚¬ìš©ì ì…ë ¥ê°’ ì‚¬ìš© (ê°•ë ¥ë¹„ë°€ë²ˆí˜¸ì˜ ê¸¸ì´ ê°•ì œí•˜ê¸°)
                numbers: forceAll || document.getElementById("numbers").checked,
                lowercase: forceAll || document.getElementById("lowercase").checked,
                uppercase: forceAll || document.getElementById("uppercase").checked,
                symbols: forceAll || document.getElementById("symbols").checked,
            };
        }

        //////////////////////////////////////////////// ë¹„ë°€ë²ˆí˜¸ ìƒì„± ë§¤ì„œë“œì— ê¸¸ì´, ì˜µì…˜ í™œì„±í™” ìœ ë¬´ë¥¼ ë„£ì–´ í˜¸ì¶œ ë° ë¹„ë°€ë²ˆí˜¸ ë Œë”ë§ /////////////////////////////////////////////// 
        function genPassword(length, forceAll = false) {
            const options = getOptions(length, forceAll);
            passwordField.value = generator.generate(options.length, options);
        }

        //////////////////////////////////////////////// ë²„íŠ¼ ëª¨ìŒ /// ìƒì„±, ê°•ë ¥(10~16ì), ì´ˆê°•ë ¥(70ì), ëœë¤ ê¸¸ì´, ë³µì‚¬///////////////////////////////////////////////        
        generateBtn.addEventListener("click", () => genPassword());
        strongBtn.addEventListener("click", () => {
            let length = Math.floor(Math.random() * 7) + 10;        
            genPassword(length, true) // true -> ëª¨ë“  ì˜µì…˜ í™œì„±í™”
        }); 
        ultraBtn.addEventListener("click", () => genPassword(70, true));
        randomLengthBtn.addEventListener("click", () => {
            lengthInput.value = Math.floor(Math.random() * 66) + 5;
        });
        copyBtn.addEventListener("click", () => {
            passwordField.select();
            document.execCommand("copy");
            alert("ë¹„ë°€ë²ˆí˜¸ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
        });
    </script>
</body>

</html>